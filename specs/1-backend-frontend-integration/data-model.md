# Data Model: Backendâ€“Frontend Integration for RAG Chatbot

**Created**: 2025-12-27
**Feature**: 1-backend-frontend-integration

## Query Request Entity

### Purpose
Represents a user's query sent to the RAG agent through the API.

### Fields
- `query` (string, required): The user's question or input text
- `sessionId` (string, optional): Identifier for conversation tracking
- `timestamp` (datetime, optional): When the query was created (server-side)

### Validation Rules
- `query` must be non-empty and have maximum length of 2000 characters
- `sessionId` must follow UUID format if provided
- `query` must contain only printable characters

## Agent Response Entity

### Purpose
Represents the response generated by the RAG agent, including content and source information.

### Fields
- `content` (string, required): The agent's response text
- `sources` (array of Source objects, optional): List of source documents used
- `query` (string, required): The original query that generated this response
- `agentId` (string, required): ID of the agent that generated the response
- `timestamp` (datetime, required): When the response was generated

### Validation Rules
- `content` must be non-empty
- `sources` array length must not exceed 10 items
- `agentId` must be a valid UUID
- `query` must match the original query sent

## Source Entity

### Purpose
Represents a source document used in generating the agent's response.

### Fields
- `id` (string, required): Unique identifier for the source
- `content` (string, required): The content of the source
- `source_url` (string, required): URL where the source can be found
- `module` (string, required): Module or section of the book this source belongs to
- `section` (string, required): Specific section within the module
- `score` (number, required): Relevance score (0.0 to 1.0)

### Validation Rules
- `id` must be non-empty
- `content` must be non-empty and have maximum length of 10000 characters
- `source_url` must be a valid URL
- `module` and `section` must be non-empty
- `score` must be between 0.0 and 1.0

## Error Response Entity

### Purpose
Represents an error response when the API encounters an issue processing a query.

### Fields
- `error` (string, required): Human-readable error message
- `code` (string, required): Machine-readable error code
- `details` (object, optional): Additional error details
- `timestamp` (datetime, required): When the error occurred

### Validation Rules
- `error` must be non-empty
- `code` must be non-empty and follow standard error code format
- `details` must be a valid object if provided

## API Request/Response Examples

### Query Request Example
```json
{
  "query": "What is Physical AI?",
  "sessionId": "550e8400-e29b-41d4-a716-446655440000"
}
```

### Successful Response Example
```json
{
  "content": "Physical AI is a field that bridges artificial intelligence with embodied systems...",
  "sources": [
    {
      "id": "doc-001",
      "content": "Physical AI represents a paradigm shift toward intelligence that is embodied...",
      "source_url": "https://example.com/book/physical-ai",
      "module": "introduction",
      "section": "definition",
      "score": 0.87
    }
  ],
  "query": "What is Physical AI?",
  "agentId": "agent-123",
  "timestamp": "2025-12-27T10:00:00Z"
}
```

### Error Response Example
```json
{
  "error": "The query is too long. Maximum 2000 characters allowed.",
  "code": "QUERY_TOO_LONG",
  "details": {
    "maxLength": 2000,
    "actualLength": 2500
  },
  "timestamp": "2025-12-27T10:00:00Z"
}
```